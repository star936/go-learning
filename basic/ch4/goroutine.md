# Go线程模型

3个核心元素:

* M: machine的缩写; 一个M代表一个内核线程.
* P: processor的缩写; 一个P代表执行一个Go代码片段所必需的资源.
    P是有状态的，值如下:
    1. Pidle: 表明当前P未与任何M存在关联
    2. Prunning: 表明当前P正在与某个M关联
    3. Psyscall: 表明当前P中运行的那个G正在进行系统调用
    4. Pgcstop: 表明运行时系统需要停止调度
    5. Pdead: 表明当前P已经不会再被使用
* G: goroutine的缩写; 一个G代表一个Go代码片段.
    G的主要状态如下:
    1. Gidle: 表明当前G刚被新分配，但还未初始化
    2. Grunnable: 表明当前G正在可运行队列中等待运行
    3. Grunning: 表明当前G正在运行
    4. Gsyscall: 表明当前G正在执行某个系统调用
    5. Gwaiting: 表明当前G正在阻塞
    6. Gdead: 表明G正在闲置
    7. Gcopystack: 表明当前G的栈正被移动（可能是栈的扩展或收缩）
    另外，还有一个称为Gscan的状态，不过它并不能独立存在，而是组合状态(与上述1-7组合)的一部分

**关系描述:**

1. 一个G的执行需要P和M的支持。一个M在与一个P关联之后，就形成了一个有效的G运行环境。每个P都会包含一个可运行的G的队列。
2. M和P之间是一对一的关系；而P与G之间是一对多的关系。
3. 因为一个G终归会由一个M来负责运行，因此M和G之间也会建立关联，它们之间的关联由P来牵线。
